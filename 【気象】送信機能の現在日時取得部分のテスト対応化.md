# 【気象】送信機能の現在日時取得部分のテスト対応化

## 目標

> 現在日時取得処理を外から定義できるようにする。
> （単体テストで固定の現在日時を設定するため）

> 運用時はシステム日時を取得、テスト時は固定の日時を取得　できるようにする。

## 対象

雨量、河川、貯留池、ポンプ場の各Actionクラス

## 方針

基本的にはnowが入るようにする。
もし$GLOBAL['time']があるならば（＝nullでないならば）、その値にする

### DateTimeクラスのインスタンス化と同時にできないか？

DateTimeクラスのインスタンス化：`new DateTime(string $datetime)`

これを使って
```
$datetime = 'now';

if (isset($GLOBALS['specified_nowtime'])) {
    $datetime = $GLOBALS['specified_nowtime'];
    // $GLOBALS['specified_nowtime']には'yyyy-mm-dd hh:ii:ss'形式で値を入れる
}

$observtime = new DateTime($datetime);
```

### 検証すべきこと

- [x] `new DateTime(string $datetime)`の引数に明示的に`'now'`を入れても現在時刻が入るのか
  - なりました
  ```
  class DateTime#1 (3) {
    public $date =>
    string(26) "2020-11-13 17:41:21.071599"
    public $timezone_type =>
    int(3)
    public $timezone =>
    string(10) "Asia/Tokyo"
  }
  ```
